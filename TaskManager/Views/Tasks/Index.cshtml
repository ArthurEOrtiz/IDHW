@{
  Layout = "_Layout";
  ViewData["Title"] = "Tasks";
}

@model IEnumerable<TaskManager.Models.UserTask>

<h2>Tasks</h2>

<table class="table table-striped table-hover table-responsive">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Title</th>
      <th scope="col">Is Completed</th>
      <th scope="col">Due Date</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody>
    @foreach (var task in Model)
    {
      <tr 
        style="cursor: pointer;" 
        onclick="window.location.href='@Url.Action("Details", "Tasks", new { id = task.Id })'"
        data-bs-toggle="tooltip" 
        title="@task.Description"
      >
        <td>@task.Title</td>
        <td>@task.IsCompleted</td>
        <td>@task.DueDate.ToString("yyyy-MM-dd")</td>
        <td onclick="event.stopPropagation();">
          <button 
            onclick="openCompleteConfirmationModal(@task.Id)"
            class="btn btn-success"
          >
            Complete
          </button>

          <button 
            onclick="openEditModal(@task.Id)"
            class="btn btn-primary"
          >
            Edit
          </button>

          <button 
            onclick="openDeleteConfirmationModal(@task.Id)"
            class="btn btn-danger"
          >
            Delete
          </button>
        </td>
      </tr>
    }
  </tbody>
</table>

<button 
  type="button" 
  class="btn btn-primary" 
  data-bs-toggle="modal" 
  data-bs-target="#createTaskModal"
>
  Create New Task
</button>

<!-- Create Modal  -->
@await Html.PartialAsync("_CreateTaskModal")

<!-- Edit Modal -->
<div id="editModalContainer"></div>

<!-- Confirmation Modal -->
@await Html.PartialAsync("_ConfirmationModal")


<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/js/tasks/index.js"></script>
